import pandas as pd
import random
from datetime import datetime

def create_carryover_file_from_data():
    """Create the carryover records file from the provided data."""
    
    # Your carryover data from the question
    data = """EXAM NUMBER	NAME	COURSE CODE	ORIGINAL SCORE	SEMESTER	SET	RESIT ATTEMPTS	BEST SCORE	STATUS	IDENTIFIED DATE
FCTCONS/ND24/007	AYO OLAMIDE PRAISE	EEd216	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/074	ILIYA QUEEN	EEd216	36	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	36	Failed	2025-10-25 19:01:33
FCTCONS/ND24/011	IGWE FAVOUR TOCHI	EEd216	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/039	GABRIEL VICTORY EHIGOCHO	EEd216	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/112	FOLORUNSHO AANUOLUWA PRECIOUS	EEd216	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/024	SULEIMAN SAMAILA	EEd216	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/045	AWYETU CHEBAWAZA DEBORAH	EEd216	45	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	45	Failed	2025-10-25 19:01:33
FCTCONS/ND24/043	NWOSU NNENNA ESTHER	EEd216	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/057	JIMOH PRINCESS RAHIMAT	EEd216	43	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	43	Failed	2025-10-25 19:01:33
FCTCONS/ND24/055	AYODELE JOHN TANTOLUWA	EEd216	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/059	OBORO MABEL OGHENEMARO	EEd216	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/053	NWEZE UKAMAKA MABEL	EEd216	45	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	45	Failed	2025-10-25 19:01:33
FCTCONS/ND24/054	BINCHAK DIANA RINGNAN	NUR221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/097	UCHE ULOMA	NUR221	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/018	IGBASAN PHILBERTA  OLUWASEUN	NUR222	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/078	CHIKWELU PRECIOUS	NUR222	43	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	43	Failed	2025-10-25 19:01:33
FCTCONS/ND24/027	BABAJI BENI DENNIS	NUR222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/134	NUHU FAVOUR AUDU	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/101	JAMES OMOH PATRICIA	NUR223	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/107	OTTO QUEEN UBUGHENAAN	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/120	EMMANUEL ZIPPORAH	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/061	EMETA NNEOMA PHILOMENA	NUR223	41	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	41	Failed	2025-10-25 19:01:33
FCTCONS/ND24/111	STANLEY SURELY ALI	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/075	DENEN RUTH DOOSE	NUR224	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/040	AGBEGE SUZAN	NUR224	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/016	UMUNNAKWE CHISOM MICHELLE	NUR224	39	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	39	Failed	2025-10-25 19:01:33
FCTCONS/ND24/128	CHIME KENECHI PAULINE	NUR224	45	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	45	Failed	2025-10-25 19:01:33
FCTCONS/ND24/087	AYODELE MUMEENAT DADA	NUR225	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/004	ABANG STEPHANIE ADA	NUR225	37	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	37	Failed	2025-10-25 19:01:33
FCTCONS/ND24/071	BOYI OJONUBA FRIDAY	NUR225	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/037	TSEGBA KUMAWUESE	NUR225	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/125	OKAH ANNA UDUMMA	NUR225	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/118	EZEDIMBU MAKUOCHUKWU GOD'SCHOICE	NUR225	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/033	UGWU PRECIOUS CHINENYE	NUR225	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/046	NKEMJIKA DABERECHI LOVETH	NUR225	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/131	TIMOTHY FAITH	NUR225	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/094	AWAJE DORCAS ASABE	NUR225	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/095	AYISA-ATANZE HAPPINESS CINCINSOKO	NUR227	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/098	SULEIMAN MARYAM HARUNA	NUS221	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/138	UCHENNA CHIGOZIE EMMANUEL	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/140	DONGAH GODSLOVE LODIYA	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/035	AGBOOLA OLATOMIWA	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/005	PAUL CHIMDINDU FAVOUR	NUS221	45	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	45	Failed	2025-10-25 19:01:33
FCTCONS/ND24/086	BARNABAS RITA SIMNOM	NUS221	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/072	DAUDA HOPE AWYETU	NUS221	47	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	47	Failed	2025-10-25 19:01:33
FCTCONS/ND24/067	ADEGOKE MARVELLOUS ARAMIDE	NUS221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/003	UDEMBA DANIELLA CHINENYE	NUS221	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/006	YOHANNA DORATHY TAVINAZA	NUS222	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/132	CHUDE ALEXANDER CHIDUBEM	NUS222	36	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	36	Failed	2025-10-25 19:01:33
FCTCONS/ND24/041	IDRIS UMMULKHAIR NDATSU	NUS222	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/076	OCHOLI TREASURE EGUYE	NUS222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/093	AMEH PRAISE CHRISTIANA	NUS222	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/019	OGAH PRINCESS UWENYI	NUR223	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/019	OGAH PRINCESS UWENYI	EEd216	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/066	OBADIAH MICAH	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/066	OBADIAH MICAH	EEd216	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/100	BAMIDELE FAVOUR DUPE	NUR224	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/100	BAMIDELE FAVOUR DUPE	EEd216	45	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	45	Failed	2025-10-25 19:01:33
FCTCONS/ND24/068	CHIKEZE MIRIAM OLUEBUBE	EEd216	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/068	CHIKEZE MIRIAM OLUEBUBE	NUR225	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/017	MOHAMMED SAVIOUR SARAH	NUS221	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/017	MOHAMMED SAVIOUR SARAH	EEd216	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/051	NDUBUISI GIFT ONYIYECHI	NUS222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/051	NDUBUISI GIFT ONYIYECHI	EEd216	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/008	OBICHEWE PAUL DAVID	NUR221	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/008	OBICHEWE PAUL DAVID	NUR222	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/001	DAVID ELISHEBA TENI	NUR221	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/001	DAVID ELISHEBA TENI	NUR222	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/136	JACOB OJIMA PENIEL	NUR221	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/136	JACOB OJIMA PENIEL	NUR224	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/106	EGBANABO REGINA OHOTU	NUR221	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/106	EGBANABO REGINA OHOTU	NUR224	35	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	35	Failed	2025-10-25 19:01:33
FCTCONS/ND24/069	STEPHEN PRECIOUS BALA	NUR221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/069	STEPHEN PRECIOUS BALA	NUR225	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/103	WAKILI SHEJIYABA CONFIDENCE	NUR221	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/103	WAKILI SHEJIYABA CONFIDENCE	NUR225	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/137	ELIZABETH DANIEL	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/137	ELIZABETH DANIEL	NUR221	41	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	41	Failed	2025-10-25 19:01:33
FCTCONS/ND24/056	MAINA SHAMMAH MUSA	NUS222	34	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	34	Failed	2025-10-25 19:01:33
FCTCONS/ND24/056	MAINA SHAMMAH MUSA	NUR221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/048	UTAN PEACE EFFIONG	NUS222	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/048	UTAN PEACE EFFIONG	NUR221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/105	IJAUKA HENRY UJI	NUR222	34	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	34	Failed	2025-10-25 19:01:33
FCTCONS/ND24/105	IJAUKA HENRY UJI	NUR224	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/084	EMMANUEL VICTORIA	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/084	EMMANUEL VICTORIA	NUR222	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/062	ABUNIMYE FELICIA AMANUYE	NUR223	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/062	ABUNIMYE FELICIA AMANUYE	NUR224	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/114	YUSUF BASHIRAT ADEOLA	NUR223	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/114	YUSUF BASHIRAT ADEOLA	NUR224	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/038	SANI ADAM ADAMU	NUR223	34	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	34	Failed	2025-10-25 19:01:33
FCTCONS/ND24/038	SANI ADAM ADAMU	NUR225	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/014	ALU EDWINA EDUGWU	NUR223	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/014	ALU EDWINA EDUGWU	NUR227	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/090	ANYIDAKWO SHEKWOYEMI GAMBO	NUS222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/090	ANYIDAKWO SHEKWOYEMI GAMBO	NUR223	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/124	IGWE GOODNESS CHINEYENWA	NUS222	30	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	30	Failed	2025-10-25 19:01:33
FCTCONS/ND24/124	IGWE GOODNESS CHINEYENWA	NUR223	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/022	OPARINDE  RUTH MOTUNRAYO	NUS222	47	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	47	Failed	2025-10-25 19:01:33
FCTCONS/ND24/022	OPARINDE  RUTH MOTUNRAYO	NUR224	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/102	MICHEAL CATHERINE	NUS221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/102	MICHEAL CATHERINE	NUR227	47	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	47	Failed	2025-10-25 19:01:33
FCTCONS/ND24/082	SADUS DYARA UMARU	NUS222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/082	SADUS DYARA UMARU	NUR227	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/083	AYENI JEMIMAH RHODA	NUS222	43	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	43	Failed	2025-10-25 19:01:33
FCTCONS/ND24/083	AYENI JEMIMAH RHODA	NUR222	36	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	36	Failed	2025-10-25 19:01:33
FCTCONS/ND24/083	AYENI JEMIMAH RHODA	EEd216	43	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	43	Failed	2025-10-25 19:01:33
FCTCONS/ND24/110	ABOKO DAVID JUNIOR	NUR221	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/110	ABOKO DAVID JUNIOR	NUR223	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/110	ABOKO DAVID JUNIOR	NUR224	39	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	39	Failed	2025-10-25 19:01:33
FCTCONS/ND24/077	OODOH COMFORT ONYENEFU	NUS221	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/077	OODOH COMFORT ONYENEFU	NUR222	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/077	OODOH COMFORT ONYENEFU	NUR223	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/002	UMAR AMINA MAKUN	NUS221	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/002	UMAR AMINA MAKUN	NUR222	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/002	UMAR AMINA MAKUN	NUR223	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/099	ABEL BENITA GIDADO	NUS221	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/099	ABEL BENITA GIDADO	NUR222	46	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	46	Failed	2025-10-25 19:01:33
FCTCONS/ND24/099	ABEL BENITA GIDADO	NUR225	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/117	EDE FAVOUR OGBA	NUR223	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/117	EDE FAVOUR OGBA	NUR224	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/117	EDE FAVOUR OGBA	NUR225	42	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	42	Failed	2025-10-25 19:01:33
FCTCONS/ND24/115	YUNUS ZULEYHAT ONIZE	NUR223	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/115	YUNUS ZULEYHAT ONIZE	NUR224	38	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	38	Failed	2025-10-25 19:01:33
FCTCONS/ND24/115	YUNUS ZULEYHAT ONIZE	NUR225	48	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	48	Failed	2025-10-25 19:01:33
FCTCONS/ND24/085	EMMANUEL HELEN	NUS221	49	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	49	Failed	2025-10-25 19:01:33
FCTCONS/ND24/085	EMMANUEL HELEN	NUR223	40	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	40	Failed	2025-10-25 19:01:33
FCTCONS/ND24/085	EMMANUEL HELEN	NUR224	44	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	44	Failed	2025-10-25 19:01:33
FCTCONS/ND24/091	DANLADI MERCY	NUS221	41	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	41	Failed	2025-10-25 19:01:33
FCTCONS/ND24/091	DANLADI MERCY	NUS222	37	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	37	Failed	2025-10-25 19:01:33
FCTCONS/ND24/091	DANLADI MERCY	NUR223	41	ND-SECOND-YEAR-SECOND-SEMESTER	ND-2024	0	41	Failed	2025-10-25 19:01:33"""
    
    # Convert string data to DataFrame
    lines = data.strip().split('\n')
    headers = lines[0].split('\t')
    rows = []
    
    for line in lines[1:]:
        rows.append(line.split('\t'))
    
    df = pd.DataFrame(rows, columns=headers)
    
    # Convert score columns to numeric
    df['ORIGINAL SCORE'] = pd.to_numeric(df['ORIGINAL SCORE'])
    df['BEST SCORE'] = pd.to_numeric(df['BEST SCORE'])
    df['RESIT ATTEMPTS'] = pd.to_numeric(df['RESIT ATTEMPTS'])
    
    # Save to Excel
    output_file = "carryover_records.xlsx"
    df.to_excel(output_file, index=False)
    print(f"✅ Created carryover file: {output_file}")
    print(f"📊 Records: {len(df)}")
    
    return output_file

def convert_carryover_to_resit_format(carryover_file_path, output_file_path, min_score=50, max_score=100):
    """
    Convert carryover long format to resit wide format with random passing scores.
    """
    
    # Read the carryover file
    try:
        df = pd.read_excel(carryover_file_path)
        print(f"✅ Loaded carryover file: {len(df)} records")
    except Exception as e:
        print(f"❌ Error reading file: {e}")
        return None
    
    # Get unique courses
    courses = sorted(df['COURSE CODE'].unique())
    print(f"📚 Found {len(courses)} unique courses: {courses}")
    
    # Get unique students
    students = df[['EXAM NUMBER', 'NAME']].drop_duplicates()
    print(f"👨‍🎓 Found {len(students)} unique students")
    
    # Count failures per course
    course_failures = df['COURSE CODE'].value_counts()
    print("\n📊 Failures per course:")
    for course, count in course_failures.items():
        print(f"   {course}: {count} students")
    
    # Create the wide format resit file
    resit_data = []
    
    for _, student in students.iterrows():
        exam_no = student['EXAM NUMBER']
        name = student['NAME']
        
        # Get all failed courses for this student
        student_failed_courses = df[df['EXAM NUMBER'] == exam_no]
        failed_course_codes = student_failed_courses['COURSE CODE'].tolist()
        
        # Create row with exam number and name
        row = {'EXAM NUMBER': exam_no, 'NAME': name}
        
        # Add random passing scores for each course the student failed
        for course in courses:
            if course in failed_course_codes:
                # Generate random passing score between min_score and max_score
                random_score = random.randint(min_score, max_score)
                row[course] = random_score
            else:
                # Student didn't fail this course, leave blank
                row[course] = ''
        
        resit_data.append(row)
    
    # Create DataFrame and save
    resit_df = pd.DataFrame(resit_data)
    
    # Reorder columns: EXAM NUMBER, NAME, then all courses
    columns_order = ['EXAM NUMBER', 'NAME'] + list(courses)
    resit_df = resit_df[columns_order]
    
    # Add timestamp to filename
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_file_path = output_file_path.replace('.xlsx', f'_{timestamp}.xlsx')
    
    # Save to Excel
    resit_df.to_excel(output_file_path, index=False)
    
    print(f"\n✅ Converted resit file saved: {output_file_path}")
    print(f"📊 Final format: {len(resit_df)} students × {len(courses)} courses")
    
    # Show summary of generated scores
    print(f"\n🎲 Score Summary (Randomly generated {min_score}-{max_score}):")
    for course in courses:
        course_scores = resit_df[course].replace('', pd.NA).dropna()
        if len(course_scores) > 0:
            avg_score = course_scores.mean()
            min_gen = course_scores.min()
            max_gen = course_scores.max()
            print(f"   {course}: {len(course_scores)} students, Avg: {avg_score:.1f}, Range: {min_gen}-{max_gen}")
    
    return resit_df

# Main execution
if __name__ == "__main__":
    print("🎯 CARRYOVER TO RESIT CONVERTER")
    print("=" * 50)
    
    # Step 1: Create the carryover file from your data
    print("\n📁 STEP 1: Creating carryover file from your data...")
    carryover_file = create_carryover_file_from_data()
    
    # Step 2: Convert to resit format
    print("\n🔄 STEP 2: Converting to resit format with random passing scores...")
    resit_file = "resit_nd_second_year_second_semester.xlsx"
    
    convert_carryover_to_resit_format(carryover_file, resit_file, min_score=50, max_score=100)
    
    print("\n🎯 NEXT STEPS:")
    print("1. Use the generated resit file with your carryover processor")
    print("2. Make sure to process the ND-SECOND-YEAR-SECOND-SEMESTER")
    print("3. Set pass threshold to 50.0")
    print("4. The script should now successfully update all scores!")